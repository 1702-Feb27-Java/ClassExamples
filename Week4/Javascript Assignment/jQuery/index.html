<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Task List</title>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>

    <style>
        html, body{
            width: 100%;
            padding: 0;
            background-color: #394264;
        }

        .container{
            margin: 0 auto;
            padding: 10px;
            width: 550px;
            border: 1px solid #333
        }

        #controls, #task-list{
            margin: 0 auto;
            width: 275px;
            font-size: 1.25em;
            padding: 5px;
        }

        #controls input, #controls button{
            font-size: .75em;
        }

        #task-list{
            min-height: 500px;
            list-style: none;
        }

        .item{
            font-size: 1.5em;
        }

        .deleter{
            color: red;
            padding-left: 5px;
            float:right;
        }

        .deleter:hover{
            cursor: pointer;
        }
    </style>
</head>
<body>

    <div class ="container">

        <div id="controls">
            <input type="text" id="new-item"/>
            <button id="add-item">Add</button>
            <br>
        </div>
        <hr>
        <ul id="task-list"></ul>
    </div>
    
    <script>
    var items = [];
    //jQuery main()
    $(document).ready(function(){
        //==========MY CODE==============
        var x = $("#task-list li").length
        if (x == 0)
        {
            printTask()
        }
        $("#box").click(styleList);
        //========== END MY CODE==============

        $("#add-item").click(addItem)

    });

    //================ MY CODE ===========================
    function printTask()
    {
        item = document.createElement('h1');

        item = $(item)
        item.attr("id","test")
        item.html("You have 0 tasks")
        $(".container").prepend(item)
    }
    function deleteTask()
    {
        $("#test").remove()
    }
    function checkList ()
    {
        var x = $("#task-list li").length
        if (x == 0)
        {
            printTask()
        }
    }
    function styleList(e)
    {
        items = $(e.target.parentNode)
        items.html(function(){
            if (this.style.color == "green")
            { 
                this.style.color = "black"
                num = $("#task-list li").length+1
                $(this).attr('prio', num)
            } 
            else 
            {
                this.style.color = "green"
                $(this).attr('prio','0')
            }})
        sortElements()
    }
    function sortElements()
    {
        $("#task-list li").sort(sort_li).appendTo('#task-list');
        function sort_li(a, b){
        return ($(b).attr('prio')) < ($(a).attr('prio')) ? 1 : -1;    
}
    }

     //================ END MY CODE ===========================

    function removeItem(item){
        console.log("removing item", item)
        delete items[item]
        item.remove()
        checkList()
        console.log(items)
    }

    function addItem(e){
        deleteTask()
        //grab the value from new-item input
        var text = $("#new-item").val()
        console.log("new item entered", text)

        //create a list item and span
        item = document.createElement('li')
        del = document.createElement('span')
        done = document.createElement('input') //----

        //select the list element
        list = $('#task-list')
        num = $('#task-list li').length +1

        //using jQuery select the newly create elements
        item = $(item)
        item.addClass('item')
        item.attr('prio', num)
        item.html(text)
        
        //DELETER
        del = $(del)
        del.addClass('deleter')
        del.html('X')
        del.click(function(e){
            item = $(e.target.parentNode)
            
            item.slideUp('fast', function(){
                removeItem(item)
            })
        })
        
        //CHECKBOX
        done = $(done)
        done.attr('type', 'checkbox')
        done.attr('id', 'box')
        done.click(styleList)

        item.append(del)
        item.prepend(done)

        list.append(item)

        //tracking purpose
        items[item] = text
        console.log(items)
    }
    </script>
</body>
</html>
